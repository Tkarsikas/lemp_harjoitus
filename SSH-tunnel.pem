# Load the data
import pandas as pd
df = pd.read_csv(r"C:\Users\tommi\Downloads\men_hmaat.csv")
from sshtunnel import SSHTunnelForwarder
from sqlalchemy import create_engine
# SSH and MySQL configuration
ssh_host = "192.168.1.154"
ssh_port = 22
ssh_username = "ubuntu"
ssh_private_key = r"C:\Users\tommi\OneDrive - University of Oulu and Oamk\Opiskelut 2025\2025 syksy 1. periodi\Linux adminstration\keys\linuxkurssikey.pem"
mysql_user = "ubuntu" # MySQL user matching the SSH username
mysql_db = "progress"
mysql_port = 3306
# Start the SSH tunnel
tunnel = SSHTunnelForwarder(
("192.168.1.154", 22), # Remote server address and SSH port
ssh_username='ubuntu',
ssh_pkey=ssh_private_key,
remote_bind_address=('127.0.0.1', 3306),
set_keepalive=10 # Keep the tunnel alive with a 60-second interval
)
tunnel.start()
print(f"Tunnel established on port: {tunnel.local_bind_port}")
# Connect through the local port forwarded by the SSH tunnel
engine = create_engine(f"mysql+pymysql://{mysql_user}@127.0.0.1:{tunnel.local_bind_port}/{mysql_db}",
pool_recycle=10, # Recycle connections after 10s
pool_pre_ping=True, # Check the connection before using it
)
print("Tunnel established on port:", tunnel.local_bind_port)
#Test connection with this cell
data = {
'viikko': [1, 2, 3],
'liike': ['penkki', 'kyykky', 'mave'],
'painot': [30, 35, 40],
}
df_test = pd.DataFrame(data)
df_test.to_sql('Persons', con=engine, if_exists='replace', index=False)